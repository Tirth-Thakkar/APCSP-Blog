---
keywords: fastai
description: Second CPT Draft Assignment 
title: CPT Draft 2
toc: true
branch: master
comments: true
tags: [week24]
categories: [week24]
nb_path: _notebooks/2023-02-28-CPTV2.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2023-02-28-CPTV2.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="3a-CPT-Video">3a <a href="https://youtu.be/BlZrp52YXsk">CPT Video</a><a class="anchor-link" href="#3a-CPT-Video"> </a></h1><h2 id="3ai-Program-Purpose">3ai Program Purpose<a class="anchor-link" href="#3ai-Program-Purpose"> </a></h2><ul>
<li>The purpose of this program is to be able to create a system where user scores are ranked and displayed in a sorted manner based on the user's score. </li>
</ul>
<h2 id="3aii">3aii<a class="anchor-link" href="#3aii"> </a></h2><ul>
<li>The video demonstrates the adding of a score to the scoreboard and then ordering the score to its corresponding location after creating the leader, only if the score is greater than 0. </li>
</ul>
<h2 id="3aiii">3aiii<a class="anchor-link" href="#3aiii"> </a></h2><ul>
<li>The inputs and outputs of this program are the following:<ul>
<li>Inputs: <ul>
<li>The user's name</li>
<li>The user's score</li>
</ul>
</li>
<li>Outputs:<ul>
<li>Success message indicating creation or telling the user score is 0</li>
<li>The user's score's location being sorted on the scoreboard </li>
</ul>
</li>
<li>These metrics prevent the leaderboard from being cluttered with scores that are 0 and creates the corresponding score table for the games that have been played. </li>
</ul>
</li>
</ul>
<h1 id="3b">3b<a class="anchor-link" href="#3b"> </a></h1><h2 id="3bi">3bi<a class="anchor-link" href="#3bi"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">leader1</span> <span class="o">=</span> <span class="n">Leader</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;sreeja&#39;</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">leader2</span> <span class="o">=</span> <span class="n">Leader</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;ekam&#39;</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">leader3</span> <span class="o">=</span> <span class="n">Leader</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;tirth&#39;</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">leader4</span> <span class="o">=</span> <span class="n">Leader</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;mani&#39;</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">leader5</span> <span class="o">=</span> <span class="n">Leader</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="s1">&#39;user&#39;</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">leaders</span> <span class="o">=</span> <span class="p">[</span><span class="n">leader1</span><span class="p">,</span> <span class="n">leader2</span><span class="p">,</span> <span class="n">leader3</span><span class="p">,</span> <span class="n">leader4</span><span class="p">,</span> <span class="n">leader5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3bii">3bii<a class="anchor-link" href="#3bii"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="sd">&quot;&quot;&quot;Builds sample user/note(s) data&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">leader</span> <span class="ow">in</span> <span class="n">leaders</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">leader</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
        <span class="k">except</span> <span class="n">IntegrityError</span><span class="p">:</span>
            <span class="sd">&#39;&#39;&#39;fails with bad or duplicate data&#39;&#39;&#39;</span>
            <span class="n">db</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Records exist, duplicate email, or error: </span><span class="si">{</span><span class="n">leader</span><span class="o">.</span><span class="n">username</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3biii">3biii<a class="anchor-link" href="#3biii"> </a></h2><ul>
<li>The name of the list is called leaders which stores 5 Leader objects. The code snippet above shows the use of a for loop to iterate through the list and follow through the create method in the Leader class which adds the Leader to the Leaderboard SQL table. Which contributes the greater functionality of the program this allows for the creation of a database with data which is then used later in the program through the use of SQL alchemy functions to be able to sort the data in the database and thus generate the filtered leaderboard and be accessed via a get request. Along with the user of other functions such as endpoints to be able to access all the scores of a selected Leader via post request specifying the desired Leader.</li>
</ul>
<h3 id="3biv">3biv<a class="anchor-link" href="#3biv"> </a></h3><ul>
<li>The data in the list leaders represent the scores that will be added to the leaderboard and then be sorted by their highest scores. </li>
</ul>
<h3 id="3bv">3bv<a class="anchor-link" href="#3bv"> </a></h3><ul>
<li>If the list was not used it would make it so that there would for one not be data to sort and search for user scores as there would be no content in the database thus making it so that the inherent functionality of the program would not be able to be used. Along with the fact that if the list was not used the creation of Leader entries. </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3c">3c<a class="anchor-link" href="#3c"> </a></h2><h2 id="3ci">3ci<a class="anchor-link" href="#3ci"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">class</span> <span class="nc">_Score</span><span class="p">(</span><span class="n">Resource</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">post</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="sd">&#39;&#39;&#39; Read data for json body &#39;&#39;&#39;</span>
            <span class="n">body</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">get_json</span><span class="p">()</span>
            <span class="n">username</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
            <span class="n">score</span> <span class="o">=</span> <span class="n">body</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;score&#39;</span><span class="p">)</span>
            <span class="n">user</span> <span class="o">=</span> <span class="n">User</span><span class="o">.</span><span class="n">query</span><span class="o">.</span><span class="n">filter</span><span class="p">((</span><span class="n">User</span><span class="o">.</span><span class="n">_username</span> <span class="o">==</span> <span class="n">username</span><span class="p">))</span><span class="o">.</span><span class="n">first</span>
            <span class="c1"># this is checking for garbage data and stopping it </span>
            <span class="k">if</span> <span class="n">username</span> <span class="o">==</span> <span class="s1">&#39;null&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;error no login&#39;</span><span class="p">},</span> <span class="mi">210</span>
            <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;error no user&#39;</span><span class="p">},</span> <span class="mi">210</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span> <span class="ow">or</span> <span class="nb">int</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;error no score&#39;</span><span class="p">},</span> <span class="mi">210</span>
        
            <span class="sd">&#39;&#39;&#39; #1: Key code block, setup USER OBJECT &#39;&#39;&#39;</span>
            <span class="n">leader</span> <span class="o">=</span> <span class="n">Leader</span><span class="p">(</span><span class="n">username</span><span class="o">=</span><span class="n">username</span><span class="p">,</span> <span class="n">score</span><span class="o">=</span><span class="n">score</span><span class="p">)</span>
            <span class="c1"># create user in database</span>
            <span class="n">user</span> <span class="o">=</span> <span class="n">leader</span><span class="o">.</span><span class="n">create</span><span class="p">()</span>
            <span class="c1"># success returns json of user</span>
            <span class="k">if</span> <span class="n">user</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">jsonify</span><span class="p">(</span><span class="n">user</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            <span class="c1"># failure returns error</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;message&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;Processed </span><span class="si">{</span><span class="n">username</span><span class="si">}</span><span class="s1">, either a format error or score </span><span class="si">{</span><span class="n">score</span><span class="si">}</span><span class="s1"> is negative or zero&#39;</span><span class="p">},</span> <span class="mi">210</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3cii">3cii<a class="anchor-link" href="#3cii"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="o">//</span> <span class="n">Get</span> <span class="n">user</span> <span class="n">ID</span> <span class="kn">from</span> <span class="nn">local</span> <span class="n">storage</span>
    <span class="n">const</span> <span class="n">userId</span> <span class="o">=</span> <span class="n">localStorage</span><span class="o">.</span><span class="n">getItem</span><span class="p">(</span><span class="s2">&quot;userid&quot;</span><span class="p">);</span>

    <span class="o">//</span> <span class="n">Define</span> <span class="n">the</span> <span class="n">endpoint</span> <span class="n">URL</span>
    <span class="n">const</span> <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;http://localhost:8086/api/leadersfiltered/score&quot;</span><span class="p">;</span>

    <span class="o">//</span> <span class="n">Define</span> <span class="n">the</span> <span class="n">request</span> <span class="n">parameters</span> <span class="k">as</span> <span class="n">an</span> <span class="nb">object</span>
    <span class="n">const</span> <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">username</span><span class="p">:</span> <span class="n">userId</span><span class="p">,</span>
      <span class="n">score</span><span class="p">:</span> <span class="n">matchCounter</span>
    <span class="p">};</span>

    <span class="o">//</span> <span class="n">Define</span> <span class="n">the</span> <span class="n">request</span> <span class="n">options</span>
    <span class="n">const</span> <span class="n">options</span> <span class="o">=</span> <span class="p">{</span>
      <span class="n">method</span><span class="p">:</span> <span class="s2">&quot;POST&quot;</span><span class="p">,</span>
      <span class="n">headers</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/json&quot;</span>
      <span class="p">},</span>
      <span class="n">body</span><span class="p">:</span> <span class="n">JSON</span><span class="o">.</span><span class="n">stringify</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="p">};</span>

    <span class="o">//</span> <span class="n">Send</span> <span class="n">the</span> <span class="n">request</span> <span class="k">with</span> <span class="n">fetch</span><span class="p">()</span>
    <span class="n">fetch</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">options</span><span class="p">)</span>
      <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">response</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="err">!</span><span class="n">response</span><span class="o">.</span><span class="n">ok</span><span class="p">)</span> <span class="p">{</span>
          <span class="n">throw</span> <span class="n">new</span> <span class="n">Error</span><span class="p">(</span><span class="s2">&quot;Network response was not ok&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">response</span><span class="o">.</span><span class="n">json</span><span class="p">();</span>
      <span class="p">})</span>
      <span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">data</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="n">console</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">data</span><span class="p">);</span>
      <span class="p">})</span>
      <span class="o">.</span><span class="n">catch</span><span class="p">(</span><span class="n">error</span> <span class="o">=&gt;</span> <span class="p">{</span>
        <span class="n">console</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;There was a problem with the fetch operation:&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">);</span>
      <span class="p">});</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3ciii">3ciii<a class="anchor-link" href="#3ciii"> </a></h2><ul>
<li>The procedure is for creating the Leader object through a post request in which the data that is received is the value from the post request that is for the username and score values. Where goes through selection statements that validate is teh user is a valid user and that if the users score is greater than 0. After which it creates a Leader object and then runs the create method which adds the Leader to the Leaderboard SQL table. Here the values are for the values of UserId and that of the matchCounter representing the user's score these are then used in the call of the function via its api endpoint.  </li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3civ">3civ<a class="anchor-link" href="#3civ"> </a></h2><p>The procedure begins by taking the values from the body of the post request such as the username and score that is sent then the function checks if the user is a valid user and if the score meets the minimum threshold via the selection statements. After which the function creates a Leader object and then runs the create method which adds the Leader to the Leaderboard SQL table.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="3d">3d<a class="anchor-link" href="#3d"> </a></h1><h2 id="3di">3di<a class="anchor-link" href="#3di"> </a></h2><p>Call #1:
<img src="https://github.com/Tirth-Thakkar/APCSP-Blog/blob/master/images/Call1.png?raw=true" alt="Call 1"></p>
<p>Call #2:
<img src="https://github.com/Tirth-Thakkar/APCSP-Blog/blob/master/images/Call2.png?raw=true" alt="Call 2"></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3dii">3dii<a class="anchor-link" href="#3dii"> </a></h2><p>What is being tested by the first call is the ability to validate if a user has a score and if not it is not possible for them to be able to send a score through the post endpoint as the users score is not allowed pass due to the selection statement giving an error 210 in the function. What is being tested in the second call is the ability to send a score if the user has a valid score and then showing the score being added to the table and then it is sorted and ranked by the highest score (this portion is a result of a another but related procedure).</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="3diii">3diii<a class="anchor-link" href="#3diii"> </a></h2><p>Output #1:
<img src="https://github.com/Tirth-Thakkar/APCSP-Blog/blob/master/images/Output1.png?raw=true" alt="Output 1">
Output #2:
<img src="https://github.com/Tirth-Thakkar/APCSP-Blog/blob/master/images/Output2.png?raw=true" alt="Output 2"></p>

</div>
</div>
</div>
</div>
 

